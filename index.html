<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R33JEXMNXN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-R33JEXMNXN');
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R33JEXMNXN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-R33JEXMNXN');
    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.cdnfonts.com/css/pickle-pushing" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">

    <title>I Want To Be A Hero</title>
    <link rel="icon" type="image/x-icon" href="resources/misc/favicon.png">
</head>



<body>
    <div id="splashScreen" class="splashScreen">
        <div class="pickle splashTitle splashFadeIn">I WANT TO BE A HERO</div>
    </div>
    <div id="offlineProgressPopup" class="blockPanel dotted"
        style="position: fixed;top:25%;right:35%;width:30%;height: 50%;z-index: 2; display: none;">
        <div class="subHeader pickle">Offline Progress</div>
        <div id="offlineProgressText" class="oxanium"></div>
        <button style="display:block;margin:auto;" class="bannerButton"
            onclick="document.getElementById('offlineProgressPopup').style.display = 'none';">Confirm</button>
    </div>
    <header>
        <!-- FPS setting to be revised -->
        <!-- <select name="updateIntervals" id="updateIntervals" onchange="changeInterval(this.value)">
            <option value="15">15FPS</option>
            <option value="30">30FPS</option>
            <option value="60">60FPS</option>
        </select> -->

    </header>

    <main>

        <section id="sidebar" class="blockPanel"></section>
        <section id="rightColumnWrap">
            <div id="heroCardPanel" class="dotted blockPanel">
                <div class="subHeader pickle">Hero card</div>
                <div id="heroCardGrid" class="">
                    <img id="heroPortraitImage" src="resources/misc/joePortrait.png"
                        style="height: 10vh; aspect-ratio: 1/1;image-rendering: pixelated;">
                    <div id="heroCardStats">
                        <div class="pickle" style="font-size: auto;margin: 1vmin;" data-resource-tooltip="">
                            Power: <span class="heroPowerText" style="font-size: auto;pointer-events: none;"
                                id="heroPowerText">0</span></div>
                        <div class="pickle moneyText" style="font-size: auto;margin: 1vmin;"
                            data-resource-tooltip="money">
                            Money: <span style="font-size: auto;pointer-events: none;" id="moneyText">0</span><span
                                id="moneyEstimateText">0</span>/min</div>
                        <div></div>
                        <div class="pickle" style="font-size: auto  ;margin: 1vmin;" data-resource-tooltip="reputation">
                            Reputation: <span style="font-size: auto;pointer-events: none;" class="reputationText"
                                id="reputationText">0</span>
                        </div>
                        <div></div>
                        <div></div>
                    </div>
                </div>
            </div>
            <div id="canvasWrap">
                <canvas id="myCanvas"></canvas>
            </div>
            <div id="logBox" class="logBox"></div>
        </section>
        <div id="tabScrollWrapper">
            <div id="tabScrollGrid">
                <section class="infoBox" id="storyBox">
                    <div class="blockHeader pickle" style="display: block">STORY</div>
                    <div class="blockBody dotted oxanium" style="padding: 10px; text-align: justify;">
                        <div id="storyText" class="verticalScroll" style="height:50%;"></div>
                        <div id="diaryContainer">
                            <div class="subHeader">Diary</div>
                            <div id="diaryGrid">
                                <div id="diaryEntries">
                                </div>
                                <div id="diaryText" class="blockPanel">Select a diary entry to view.</div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="infoBox" id="statusBox">
                    <div class="blockHeader pickle">STATUS</div>
                    <div class="blockBody dotted">
                        <div id="barWrap">
                            <span class="barText leftAlign pickle" id="playerLevelText">
                                LEVEL
                            </span>
                            <span id="playerExperienceText" class="barText pickle">0</span>
                            <progress id="playerExperienceBar" value="100" max="1000"></progress>
                            <span class="barText leftAlign pickle">
                                HEALTH
                            </span>
                            <span id="playerHealthText" class="barText pickle">0</span>
                            <progress id="playerHealthBar" value="100" max="1000"></progress>
                            <span id="playerInitiativeText" class="barText pickle">0</span>
                            <progress id="playerInitiativeBar" value="100" max="1000"></progress>
                        </div>
                        <div id="resourceEstimates" style="display: grid; grid-template-columns: 50% 50%;">
                            <div id="expEstimate" class="pickle">Experience/min: <span id="expEstimateText">0</span>
                            </div>
                            <!-- <div id="moneyEstimate" class="pickle">Money/min: <span id="moneyEstimateText">0</span>
                            </div> -->
                        </div>

                        <div class="statDisplay pickle blockPanel" id="nextMove">Next move: <span
                                id="playerMoveText">0</span></div>
                        <div class="pickle blockPanel">
                            <label for="quantity">Engagement distance:</label>
                            <input class="pickle" style="background: whitesmoke;width: 10%;" type="number"
                                onchange="changeEngagementRange()" id="engagementDistanceInput" name="quantity" min="5"
                                max="70" step="5">
                            <label for="quantity">Rest until HP:</label>
                            <input class="pickle" style="background: whitesmoke;width: 10%;" type="number"
                                onchange="changeRestPercentage()" id="restPercentageInput" name="quantity" min="0"
                                max="100" step="5">%
                        </div>
                        <br>
                        <div class="pickle subHeader">Attributes:</div>
                        <div id="statsGrid">
                            <div class="statDisplay pickle">
                                STR: <span class="strengthText" id="strengthText"
                                    data-attribute-tooltip="strength">0</span>
                            </div>
                            <div class="statDisplay pickle">
                                TGH: <span class="toughnessText" id="toughnessText"
                                    data-attribute-tooltip="toughness">0</span>
                            </div>
                            <div class="statDisplay pickle">
                                MND: <span class="mindText" id="mindText" data-attribute-tooltip="mind">0</span>
                            </div>
                            <div class="statDisplay pickle">
                                AGI: <span class="agilityText" id="agilityText"
                                    data-attribute-tooltip="agility">0</span>
                            </div>
                        </div>
                        <div class="pickle subHeader">Active abilities:</div>
                        <div class="blockBody" id="abilityLoadoutContainer" style="height:auto ;display: grid;grid-template-columns: auto;
                        grid-auto-flow:column;column-gap: normal;justify-items: center;">
                        </div>
                        <div class="pickle subHeader">Current activity: (<span id="trainingBarOverviewIcon"></span>)
                            <span id="trainingCanUpgradeText"></span>
                        </div>
                        <div
                            style="width: -webkit-fill-available;height: 40px;margin-left: 10px;margin-right: 10px;margin:1%">
                            <progress id="trainingProgressBarOverview" class="trainingProgressBar" value="100"
                                max="1000"></progress>
                        </div>
                        <div class="pickle subHeader">Story Progression</div>
                        <div id="storyRequirementsOverviewText" class="pickle" style="text-align: center;padding: 1%;">
                        </div>
                    </div>
                </section>
                <section class="infoBox" id="trainingBox">
                    <div class="blockHeader pickle">ACTIVITIES</div>
                    <div id="trainingAreaDisplay" class="blockBody dotted">
                        <div class="subHeader pickle">Base attributes from training</div>
                        <div id="statsGrid" style="display: grid;">
                            <div id="strengthStatText" class="statDisplay pickle">
                                Strength: <span class="strengthText" id="strengthSoftcapText">0</span>
                            </div>
                            <div id="toughhnessStatText" class="statDisplay pickle">
                                Toughness: <span class="toughnessText" id="toughnessSoftcapText">0</span>
                            </div>
                            <div id="mindStatText" class="statDisplay pickle">
                                Mind: <span class="mindText" id="mindSoftcapText">0</span>
                            </div>
                            <div id="agilityStatText" class="statDisplay pickle">
                                Agility: <span class="agilityText" id="agilitySoftcapText">0</span>
                            </div>
                        </div>
                        <div id="trainingAreaName" class="statDisplay pickle"
                            style="text-overflow:ellipsis;white-space: nowrap; overflow: hidden;"></div>
                        <div style="width: -webkit-fill-available;height: 40px;margin-left: 10px;margin-right: 10px;">
                            <progress id="trainingProgressBar" class="trainingProgressBar" style="width:inherit;"
                                value="100" max="1000"></progress>
                        </div>
                        <div id="activityGrid" class="blockPanel" style="display:grid;grid-template-columns: 49.5% 49.5%;grid-auto-rows: min-content;
                        height: 50%;gap:1%;overflow-y: scroll;overflow-x:hidden;">

                        </div>


                    </div>
                </section>
                <section class="infoBox" id="areasBox">
                    <div class="blockHeader pickle">AREAS</div>
                    <div id="selectArea" class="blockBody dotted verticalScroll">
                    </div>

                </section>
                <section class="infoBox" id="skillsBox">
                    <div class="blockHeader pickle" style="display: block">CLASS</div>
                    <div class="blockBody dotted pickle" id="skillsWrap">
                        <div>Class: <span id="classText"></span></div>
                        <div>Points available: <span id="passivePointsText"></span></div>
                        <button class="bannerButton" style="position: absolute;top:0;right:0;"
                            onclick="resetSkills()">Reset</button>
                        <div class="subHeader">Trees</div>
                        <div id="subClassTabContainer"></div>
                        <div id="passiveTreeContainer" class="blockPanel verticalScroll" style="height: 76vh;">
                            <!-- <div class="gridSkills" id="passiveTreeGrid"></div> -->
                        </div>
                    </div>
                </section>
                <section class="infoBox" id="fameBox">
                    <div class="blockHeader pickle" style="display: block">FAME</div>
                    <div class="blockBody dotted pickle">
                        <div style="height: 22vh;">
                            <div class="oxanium">As your reputation starts to spread, you gain fame points. Fame points
                                can be allocated to give various passive bonuses.<br>
                                You can reset your point allocation by Rebranding (requires double click). WARNING! This
                                costs 1% of your current reputation! </div>
                            <br><button ondblclick="resetFameUpgrades()" class="bannerButton">Rebrand</button><br>
                            <div class="pickle">Fame: <span id="famePointText"></span></div>
                            <div class="pickle">Next at: <span id="fameToNextText"></span><span
                                    class="reputationText"></span></div>
                        </div>
                        <div id="fameUpgradeContainer" class="blockPanel verticalScroll" style="height: 70vh;"></div>
                    </div>
                </section>
                <section class="infoBox" id="prestigeBox">
                    <div class="blockHeader pickle" style="display: block">PRESTIGE</div>

                    <div class="blockBody dotted pickle">
                        <div style="display:grid;height:100%;grid-template-rows: 5% 95%;overflow:hidden;">
                            <div id="prestigeTabHeader"
                                style="display:grid;grid-auto-columns: 1fr;grid-auto-flow: column;">
                                <div class="bannerButton prestigePanelTab" onclick="changePrestigeTab(0)">Attribute
                                </div>
                                <div class="bannerButton prestigePanelTab" onclick="changePrestigeTab(1)">Class</div>
                            </div>
                            <div id="attributePrestigePanel">
                                <div class="subHeader">Overtraining</div>
                                <div class="oxanium">Going over your limits is hard, and every second you don't spend training you lose some of your power over the limit.
                                    For every attribute point you lose this way, you gain a permanent bonus. This bonus is stronger the less attributes you have, reaching a minimum when you reach your limit.
                                </div>
                                <div id="attributeDecayText" class="oxanium" style="text-align: center;padding:3%">

                                </div>
                                <div class="subHeader">Softcaps</div>
                                <div id="attributePrestigeText" style="text-align: center;padding:3%">

                                </div>
                                <button style="display:block; margin:auto" class="bannerButton"
                                    onclick="attributePrestige()">Take Y</button>
                                <br>
                                <div style="line-height:1.5;" class="oxanium"> You can take the Y you found to unlock
                                    more of your power.<br><br>
                                    This will reset your attributes.<br><br>
                                    Your limit will increase to their current value above the limit (limit cannot decrease).<br><br>
                                    You gain 1% of the limit as permanent attributes when you reset this way. (They
                                    cannot be lowered below that value by activities)<br><br>

                                </div>
                            </div>
                            <div id="classPrestigePanel">
                                <div style="line-height:1.5;" class="oxanium">
                                    Prestige your class to the next hero rank to gain even more power to become the most
                                    powerful hero<br>
                                    <div class="subHeader pickle">Requirements:</div>
                                    <div class="blockPanel">
                                        Level: <span class="cpLevelRequirement">0</span><br>
                                        Story Progress: <span class="cpStoryRequirement">0</span><br>
                                        Total softcap: <span class="cpSoftcapRequirement">0</span><br>
                                    </div>
                                    Your class prestige bonus will become:<br>
                                    <div class="blockPanel">
                                        Attribute Gain: <span class="cpReward1">0</span><br>
                                        Bonus Passive Points: <span class="cpReward2">0</span><br>
                                        Activity EXP: <span class="cpReward3">0</span><br>
                                    </div>
                                    You lose all your levels when you class prestige, keeping your softcaps (forces an
                                    attribute prestige)<br>

                                    You can advance one of your subclass trees with this prestige
                                </div>
                                
                                <div id="classPrestigePick" style="display:flex; gap: 10%; justify-content: center;">
                                    <div class="bannerButton subclassPickButton" ></div>
                                    <div class="bannerButton subclassPickButton" ></div>
                                    <div class="bannerButton subclassPickButton"></div>
                                </div>
                                <div class="subHeader">Preview</div>
                                <div id="subclassPreviewGrid" class="blockPanel" style="height:13%;display: grid; grid-template-columns: repeat(5,1fr);
                                grid-auto-rows: 1fr; gap:5%;    align-items: center;justify-items: center;">

                                </div>
                                <button style="display:block; margin:auto" class="bannerButton"
                                    onclick="classPrestige()">Advance rank</button>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="infoBox" id="helpBox">
                    <div class="blockHeader pickle" style="display: block">HELP</div>
                    <div class="blockBody dotted pickle verticalScroll  " id="helpBody" style="overflow-y:scroll">
                        <div style="text-transform: uppercase; font-size: 2.5vw;">Join the <a
                                href="https://discord.gg/HzVyvdQnkW" target=”_blank”>DISCORD</a><img
                                src="resources/misc/discordIcon.svg" style="
                            margin-bottom: -0.6vw; height: 3vw;"><br></div>
                        <div class="subHeader">Combat</div>
                        Your hero automatically uses his abilities in combat. Combat is action gauge based, once it
                        fills the prepared ability is used.
                        You can also set which abilities to use once you unlock more by clicking on the slots on the
                        status tab.
                        Finding criminals takes some time (patrolling time) after which you'll enter an
                        encounter.
                        If you are defeated in combat you'll take some downtime to recover (10 seconds).
                        <div class="subHeader">Movement</div>
                        You can set the engagement range, which is how close your hero will try to get to the enemy.
                        He will only move this close and not further, so make sure your engagement range matches your
                        abilities! By default your hero cannot move back after closing distance. However, if you have an
                        ability with 'Retreat' he will try to use it to move back to his engagement range if an enemy
                        closes in.
                        <br \>
                        <div class="subHeader">Attributes</div>

                        <br \><span class="pickle strengthText">STR</span>increases your damage reduction.
                        <br \><span class="pickle toughnessText">TGH</span>increases your maximum health.
                        <br \><span class="pickle mindText">MND</span>reduces your ability cooldowns.
                        <br \><span class="pickle agilityText">AGI</span>increases your action speed.
                        <br \>
                        <br \>Attributes can be increased by training.
                        <div class="subHeader">Training</div>
                        Training is done through activities. Each completion gives PlayerLevel*AttributeRatio
                        attributes.
                        The starting activities are free but more rewarding activities that you unlock as you progress
                        cost money to perform.
                        <br \>
                        As you complete the same activity, it gains experience and can rank up. Ranking up increases the
                        reward multiplier.
                        Ranking up needs more experience every time, but later ranks are successively more rewarding.
                        <br \>
                        New activities may not even be worth it until you gain some experience in doing them.
                        <br \>
                        The more of the activity's respective stat you have the more experience you earn doing it.
                        <div class="subHeader">Abilities</div>
                        <br \>Your first ability is Punch. Punch's damage ratio is 80% <span
                            class="pickle strengthText">STR</span> 20% <span class="pickle agilityText">AGI</span>,
                        which is to say that,
                        that
                        percentage of the respective attribute value is used in the move's damage formula.
                        <br \>The damage formula is:
                        <br \><img id="damageFormula" src="resources/misc/damageFormulaInvert.png" />,
                        where the second part is evaluated and then summed from every contributing attribute.
                        <br \>
                        <br \> The damage ratio of abilities can be found by hovering them on the "Abilities" tab.
                        <br \> Abilities also have a damage range, which modifies the final damage, a use time and a
                        cooldown.
                        Cooldowns only start AFTER the abiltiy is used. Some ranged skills have a minimum range, the
                        screen is 100 units wide.

                        <div class="subHeader">Additional mechanics</div>
                        <br \>Heal: heal for an amount.
                        <br \>
                        <br \>Shield: gives temporary health points. Lost at the end of an encounter. Does not stack,
                        stronger shields overwrite.
                        <br \>
                        <br \>AoE: also hits other targets in that range.
                        <br \>
                        <br \>Critical strike: chance to deal 50% more damage.
                        <br \>
                        <br \>Health regeneration: health regeneration per second in combat.
                        <br \>
                        <br \>Overwhelm: increases damage based on enemy current hp (higher hp = more damage).
                        <br \>
                        <br \>Takedown: increases damage based on enemy current hp (lower hp = more damage).
                        <br \> 
                        <br \>Rush: moves along with attacking.
                        <br \>
                        <br \>Repeat: Chance to use again without cooldown. Successive repeats half the chance.
                    </div>
                </section>
                <section class="infoBox" id="optionsBox">
                    <div class="blockHeader pickle" style="display: block">OPTIONS</div>
                    <div class="blockBody dotted pickle verticalScroll">
                        <span class="pickle" id="versionText" style="display: block; text-align: right;">v0.02
                            Alpha</span>
                        <h1 class="title pickle" style="display: block; font-size: 2em;">
                            I WANT TO BE A HERO
                        </h1>
                        <br>
                        <br>
                        <button class="bannerButton" onclick="toggleMusic()">Toggle Music</button>
                        <input type="range" min="1" max="100" value="20" class="slider" id="volumeSlider"
                            onchange="setVolume(this.value)">
                        <br>
                        <br>
                        <button class="bannerButton" onclick="(function(){save();logConsole('Saved!')})()">Save Game</button>
                        <button class="bannerButton" onclick="exportGame()">Export</button>
                        <button class="bannerButton" onclick="importGame()">Import</button>

                        <button class="bannerButton" onclick="hardReset()">HARD RESET</button>
                        <br>
                        <br>
                        <label for="customPortraitInput" class="bannerButton" style="padding: 2px;">
                            Upload Custom Hero Portrait!
                        </label>
                        <input style="display: none;" type="file" id="customPortraitInput"
                            accept="image/jpeg, image/png, image/jpg">
                        <button id="resetPortraitButton" class="bannerButton"> Reset Portrait</button>
                        <br>
                        <br>
                        <button id="resetAutoButton" class="bannerButton" onclick="resetAutoUpgrades()"> Reset Automation Upgrades</button>
                        <br>
                        <br>
                        <button id="resetAreaButton" class="bannerButton" onclick="(function(){console.log('test');currentArea = areas[0];changeArea(0);})()"> Reset Area</button>
                        <br>
                        <br>
                        <div class="subHeader">Credits</div>
                        <div id="credits">
                            Music & Many Backgrounds, Luis Zuno, <a href="https://ansimuz.itch.io/" target=”_blank”>itch.io</a>
                        </div>

                        <audio controls muted id="audioSource" style="display: none;">
                            <source src="resources/music/cyberpunk-street.mp3" type="audio/mp3">
                            Your browser does not support the audio element.
                        </audio>
                    </div>
            </div>
            </section>
        </div>
        </div>
        </div>

    </main>
</body>

</html>
<script src="src/worker.js"></script>
<script src="src/constants.js"></script>
<script src="src/colors.js"></script>
<script src="src/playerstats.js"></script>
<script src="src/combat.js"></script>
<script src="src/enemies.js "></script>
<script src="src/allies.js "></script>
<script src="src/areas.js"></script>
<script src="src/story.js"></script>
<script src="src/classTreeData.js"></script>
<script src="src/classAbilityData.js"></script>
<script src="src/class.js"></script>
<script src="src/prestige.js"></script>
<script src="src/fame.js"></script>
<script src="src/training.js"></script>
<script src="src/music.js"></script>
<script src="src/offline.js"></script>
<script src="src/main.js"></script>